---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: master
  name: 04-accelerated-container-startup-master
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,IyEvYmluL2Jhc2gKIwojIFRlbXBvcmFyaWx5IHJlc2V0IHRoZSBjb3JlIHN5c3RlbSBwcm9jZXNzZXMncyBDUFUgYWZmaW5pdHkgdG8gYmUgdW5yZXN0cmljdGVkIHRvIGFjY2VsbGVyYXRlIHN0YXJ0dXAgYW5kIHNodXRkb3duCiMKIyBUaGUgZGVmYXVsdHMgYmVsb3cgY2FuIGJlIG92ZXJyaWRkZW4gdmlhIGVudmlyb25tZW50IHZhcmlhYmxlcwojCgojIFRoZSBkZWZhdWx0IHNldCBvZiBjcml0aWNhbCBwcm9jZXNzZXMgd2hvc2UgYWZmaW5pdHkgc2hvdWxkIGJlIHRlbXBvcmFyaWx5IHVuYm91bmQ6CkNSSVRJQ0FMX1BST0NFU1NFUz0ke0NSSVRJQ0FMX1BST0NFU1NFUzotInN5c3RlbWQgb3ZzIGNyaW8ga3ViZWxldCBOZXR3b3JrTWFuYWdlciBjb25tb24gZGJ1cyJ9CgojIERlZmF1bHQgd2FpdCB0aW1lIGlzIDYwMHMgPSAxMG06Ck1BWElNVU1fV0FJVF9USU1FPSR7TUFYSU1VTV9XQUlUX1RJTUU6LTYwMH0KCnVucmVzdHJpY3RlZENwdXNldCgpIHsKICBpZiBbWyAhIC1lIC92YXIvbGliL2t1YmVsZXQvY3B1X21hbmFnZXJfc3RhdGUgXV07IHRoZW4KICAgIHJldHVybiAxCiAgZmkKICBqcSAtciAnLmRlZmF1bHRDcHVTZXQnIDwvdmFyL2xpYi9rdWJlbGV0L2NwdV9tYW5hZ2VyX3N0YXRlCn0KCnJlc3RyaWN0ZWRDcHVzZXQoKSB7CiAgZm9yIGFyZyBpbiAkKDwvcHJvYy9jbWRsaW5lKTsgZG8KICAgIGlmIFtbICRhcmcgPX4gXnN5c3RlbWQuY3B1X2FmZmluaXR5PSBdXTsgdGhlbgogICAgICBlY2hvICR7YXJnIyo9fQogICAgICByZXR1cm4gMAogICAgZmkKICBkb25lCiAgcmV0dXJuIDEKfQoKbG9nQWZmaW5pdHkoKSB7CiAgZWNobyAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIKICBmb3IgcHJvYyBpbiAkQ1JJVElDQUxfUFJPQ0VTU0VTOyBkbwogICAgZWNobyAiLSAkcHJvYyIKICAgIGxvY2FsIHBpZHM9IiQocGdyZXAgJHByb2MpIgogICAgZm9yIHBpZCBpbiAkcGlkczsgZG8KICAgICAgdGFza3NldCAtcCAkcGlkIHwgc2VkIC1lICdzL14vICAtIC8nCiAgICBkb25lCiAgZG9uZQp9CgpyZXNldEFmZmluaXR5KCkgewogIGxvY2FsIGNwdXNldD0iJDEiCiAgbG9jYWwgZmFpbGNvdW50PTAKICBsb2NhbCBzdWNjZXNzY291bnQ9MAogIGVjaG8gIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgZWNobyAiU2V0dGluZyBDUFUgYWZmaW5pdHkgZm9yIGNyaXRpY2FsIHByb2Nlc3NlcyBcIiRDUklUSUNBTF9QUk9DRVNTRVNcIiB0byAkY3B1c2V0IgogIGZvciBwcm9jIGluICRDUklUSUNBTF9QUk9DRVNTRVM7IGRvCiAgICBlY2hvICItICRwcm9jIgogICAgbG9jYWwgcGlkcz0iJChwZ3JlcCAkcHJvYykiCiAgICBmb3IgcGlkIGluICRwaWRzOyBkbwogICAgICBsb2NhbCB0YXNrc2V0T3V0cHV0CiAgICAgIHRhc2tzZXRPdXRwdXQ9IiQodGFza3NldCAtYXBjICIkY3B1c2V0IiAkcGlkIDI+JjEpIgogICAgICBpZiBbWyAkPyAtbmUgMCBdXTsgdGhlbgogICAgICAgIGVjaG8gIkVSUk9SOiAkdGFza3NldE91dHB1dCIKICAgICAgICAoKGZhaWxjb3VudCsrKSkKICAgICAgZWxzZQogICAgICAgICgoc3VjY2Vzc2NvdW50KyspKQogICAgICBmaQogICAgICB0YXNrc2V0IC1wICRwaWQgfCBzZWQgLWUgJ3MvXi8gIC0gLycKICAgIGRvbmUKICBkb25lCiAgZWNobyAiUmUtYWZmaW5lZCAkc3VjY2Vzc2NvdW50IHBpZHMgc3VjY2Vzc2Z1bGx5IgogIGlmIFtbICRmYWlsY291bnQgLWd0IDAgXV07IHRoZW4KICAgIGVjaG8gIkZhaWxlZCB0byByZS1hZmZpbmUgJGZhaWxjb3VudCBwcm9jZXNzZXMiCiAgICByZXR1cm4gMQogIGZpCn0KCnNldFVucmVzdHJpY3RlZCgpIHsKICBsb2dnZXIgIlNldHRpbmcgY3JpdGljYWwgc3lzdGVtIHByb2Nlc3NlcyB0byBoYXZlIHVucmVzdHJpY3RlZCBDUFUgYWNjZXNzIgogIHJlc2V0QWZmaW5pdHkgIiQodW5yZXN0cmljdGVkQ3B1c2V0KSIKfQoKc2V0UmVzdHJpY3RlZCgpIHsKICBsb2dnZXIgIlJlc2V0dGluZyBjcml0aWNhbCBzeXN0ZW0gcHJvY2Vzc2VzIGJhY2sgdG8gbm9ybWFsbHkgcmVzdHJpY3RlZCBhY2Nlc3MiCiAgcmVzZXRBZmZpbml0eSAiJChyZXN0cmljdGVkQ3B1c2V0KSIKfQoKY3VycmVudEFmZmluaXR5KCkgewogIGxvY2FsIHBpZD0iJDEiCiAgdGFza3NldCAtcGMgJHBpZCB8IGF3ayAtRic6ICcgJ3twcmludCAkMn0nCn0KCndhaXRGb3JSZWFkeSgpIHsKICBlY2hvICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogIGVjaG8gIldhaXRpbmcgJHtNQVhJTVVNX1dBSVRfVElNRX1zIGZvciB0aGUgaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUiCiAgbG9jYWwgbGFzdFN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogIGxvY2FsIGxhc3REZXNpcmVkQ3B1c2V0PSIkKHVucmVzdHJpY3RlZENwdXNldCkiCiAgbG9jYWwgdD0wIHM9MTAKICB3aGlsZSBbWyAkdCAtbHQgJE1BWElNVU1fV0FJVF9USU1FIF1dOyBkbwogICAgIyBUT0RPOiBDYW4gd2UgcXVlcnkgdGhlIHN0YXRlIHNvbWVob3cgYW5kIGludGVycnVwdCB0aGlzIHNvb25lcj8KICAgICMgRG9lcyAnY3Jpbycga25vdyB3aGVuIHdlJ3JlICJkb25lIj8gIE1heWJlIHZpYSAnY3JpY3RsIHBzIHwgZ3JlcCBQZW5kaW5nIHwgd2MgLWwnPwogICAgbG9jYWwgcGVuZGluZz0kKGNyaWN0bCBwcyB8IGdyZXAgUGVuZGluZyB8IHdjIC1sKQogICAgZWNobyAiREVCVUc6IENyaW8gbGlzdHMgJHBlbmRpbmcgY29udGFpbmVycyBhcyBQZW5kaW5nIgogICAgc2xlZXAgJHMKICAgICgodCArPSBzKSkKICAgIGxvY2FsIHN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogICAgbG9jYWwgZGVzaXJlZENwdXNldD0iJCh1bnJlc3RyaWN0ZWRDcHVzZXQpIgogICAgIyBCZWNhdXNlICd0dW5lZCcgbWF5IG1lc3Mgd2l0aCB1cywgYW5kIHRoZSBhbGxvd2VkIHNldCBvZiB1bnJlc2VydmVkCiAgICAjIGNvcmVzIG1heSBjaGFuZ2UgYXMgcG9kcyBjb21lIHVwLCB3ZSBuZWVkIHRvIHJlYXNzZXJ0IHRoZSB1bnJlc3RyaWN0ZWQKICAgICMgYWZmaW5pdHkgaWYgaXQncyBub3QgY29ycmVjdAogICAgaWYgW1sgJHN5c3RlbWRDcHVzZXQgIT0gJGxhc3RTeXN0ZW1kQ3B1c2V0IHx8ICRsYXN0RGVzaXJlZENwdXNldCAhPSAkZGVzaXJlZENwdXNldCBdXTsgdGhlbgogICAgICByZXNldEFmZmluaXR5ICIkZGVzaXJlZENwdXNldCIKICAgICAgbGFzdFN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogICAgICBsYXN0RGVzaXJlZENwdXNldD0iJGRlc2lyZWRDcHVzZXQiCiAgICBmaQogIGRvbmUKfQoKaWYgISB1bnJlc3RyaWN0ZWRDcHVzZXQgPiYvZGV2L251bGw7IHRoZW4KICBlY2hvICJObyB1bnJlc3RyaWN0ZWQgQ3B1c2V0IGNvdWxkIGJlIGRldGVjdGVkLiAgUGVyaGFwcyBrdWJlbGV0IGlzIG5vdCBydW5uaW5nIHlldD8iCiAgZXhpdCAxCmZpCgppZiAhIHJlc3RyaWN0ZWRDcHVzZXQgPiYvZGV2L251bGw7IHRoZW4KICBlY2hvICJObyByZXN0cmljdGVkIENwdXNldCBoYXMgYmVlbiBjb25maWd1cmVkLiAgV2UgYXJlIGFscmVhZHkgcnVubmluZyB1bnJlc3RyaWN0ZWQuIgogIGV4aXQgMApmaQoKIyBFbnN1cmUgd2UgcmVzZXQgdGhlIENQVSBhZmZpbml0eSB3aGVuIHdlIGV4aXQgdGhpcyBzY3JpcHQgZm9yIGFueSByZWFzb24KIyBUaGlzIHdheSBlaXRoZXIgYWZ0ZXIgdGhlIHRpbWVyIGV4cGlyZXMgb3IgYWZ0ZXIgdGhlIHByb2Nlc3MgaXMgaW50ZXJydXB0ZWQKIyB2aWEgXkMgb3IgU0lHVEVSTSwgd2UgcmV0dXJuIHRoaW5ncyBiYWNrIHRvIHRoZSB3YXkgdGhleSBzaG91bGQgYmUuCnRyYXAgc2V0UmVzdHJpY3RlZCBFWElUCgpzZXRVbnJlc3RyaWN0ZWQKd2FpdEZvclJlYWR5Cg==
        mode: 493
        path: /usr/local/bin/accelerated-container-startup.sh
    systemd:
      units:
      - contents: |
          [Path]
          PathExists=/var/lib/kubelet/cpu_manager_state

          [Install]
          WantedBy=multi-user.target
        enabled: true
        name: accelerated-container-startup.path
      - contents: |
          [Unit]
          Description=Unlocks more CPUs for critical system processes during container startup
          After=kubelet.service

          [Service]
          Type=simple
          ExecStart=/usr/local/bin/accelerated-container-startup.sh
        enabled: true
        name: accelerated-container-startup.service
      - contents: |
          [Unit]
          Description=Unlocks more CPUs for critical system processes during container shutdown
          DefaultDependencies=no

          [Service]
          Type=simple
          ExecStart=/usr/local/bin/accelerated-container-startup.sh

          [Install]
          WantedBy=shutdown.target reboot.target halt.target
        enabled: true
        name: accelerated-container-shutdown.service
---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker
  name: 04-accelerated-container-startup-worker
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
      - contents:
          source: data:text/plain;charset=utf-8;base64,IyEvYmluL2Jhc2gKIwojIFRlbXBvcmFyaWx5IHJlc2V0IHRoZSBjb3JlIHN5c3RlbSBwcm9jZXNzZXMncyBDUFUgYWZmaW5pdHkgdG8gYmUgdW5yZXN0cmljdGVkIHRvIGFjY2VsbGVyYXRlIHN0YXJ0dXAgYW5kIHNodXRkb3duCiMKIyBUaGUgZGVmYXVsdHMgYmVsb3cgY2FuIGJlIG92ZXJyaWRkZW4gdmlhIGVudmlyb25tZW50IHZhcmlhYmxlcwojCgojIFRoZSBkZWZhdWx0IHNldCBvZiBjcml0aWNhbCBwcm9jZXNzZXMgd2hvc2UgYWZmaW5pdHkgc2hvdWxkIGJlIHRlbXBvcmFyaWx5IHVuYm91bmQ6CkNSSVRJQ0FMX1BST0NFU1NFUz0ke0NSSVRJQ0FMX1BST0NFU1NFUzotInN5c3RlbWQgb3ZzIGNyaW8ga3ViZWxldCBOZXR3b3JrTWFuYWdlciBjb25tb24gZGJ1cyJ9CgojIERlZmF1bHQgd2FpdCB0aW1lIGlzIDYwMHMgPSAxMG06Ck1BWElNVU1fV0FJVF9USU1FPSR7TUFYSU1VTV9XQUlUX1RJTUU6LTYwMH0KCnVucmVzdHJpY3RlZENwdXNldCgpIHsKICBpZiBbWyAhIC1lIC92YXIvbGliL2t1YmVsZXQvY3B1X21hbmFnZXJfc3RhdGUgXV07IHRoZW4KICAgIHJldHVybiAxCiAgZmkKICBqcSAtciAnLmRlZmF1bHRDcHVTZXQnIDwvdmFyL2xpYi9rdWJlbGV0L2NwdV9tYW5hZ2VyX3N0YXRlCn0KCnJlc3RyaWN0ZWRDcHVzZXQoKSB7CiAgZm9yIGFyZyBpbiAkKDwvcHJvYy9jbWRsaW5lKTsgZG8KICAgIGlmIFtbICRhcmcgPX4gXnN5c3RlbWQuY3B1X2FmZmluaXR5PSBdXTsgdGhlbgogICAgICBlY2hvICR7YXJnIyo9fQogICAgICByZXR1cm4gMAogICAgZmkKICBkb25lCiAgcmV0dXJuIDEKfQoKbG9nQWZmaW5pdHkoKSB7CiAgZWNobyAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIKICBmb3IgcHJvYyBpbiAkQ1JJVElDQUxfUFJPQ0VTU0VTOyBkbwogICAgZWNobyAiLSAkcHJvYyIKICAgIGxvY2FsIHBpZHM9IiQocGdyZXAgJHByb2MpIgogICAgZm9yIHBpZCBpbiAkcGlkczsgZG8KICAgICAgdGFza3NldCAtcCAkcGlkIHwgc2VkIC1lICdzL14vICAtIC8nCiAgICBkb25lCiAgZG9uZQp9CgpyZXNldEFmZmluaXR5KCkgewogIGxvY2FsIGNwdXNldD0iJDEiCiAgbG9jYWwgZmFpbGNvdW50PTAKICBsb2NhbCBzdWNjZXNzY291bnQ9MAogIGVjaG8gIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgZWNobyAiU2V0dGluZyBDUFUgYWZmaW5pdHkgZm9yIGNyaXRpY2FsIHByb2Nlc3NlcyBcIiRDUklUSUNBTF9QUk9DRVNTRVNcIiB0byAkY3B1c2V0IgogIGZvciBwcm9jIGluICRDUklUSUNBTF9QUk9DRVNTRVM7IGRvCiAgICBlY2hvICItICRwcm9jIgogICAgbG9jYWwgcGlkcz0iJChwZ3JlcCAkcHJvYykiCiAgICBmb3IgcGlkIGluICRwaWRzOyBkbwogICAgICBsb2NhbCB0YXNrc2V0T3V0cHV0CiAgICAgIHRhc2tzZXRPdXRwdXQ9IiQodGFza3NldCAtYXBjICIkY3B1c2V0IiAkcGlkIDI+JjEpIgogICAgICBpZiBbWyAkPyAtbmUgMCBdXTsgdGhlbgogICAgICAgIGVjaG8gIkVSUk9SOiAkdGFza3NldE91dHB1dCIKICAgICAgICAoKGZhaWxjb3VudCsrKSkKICAgICAgZWxzZQogICAgICAgICgoc3VjY2Vzc2NvdW50KyspKQogICAgICBmaQogICAgICB0YXNrc2V0IC1wICRwaWQgfCBzZWQgLWUgJ3MvXi8gIC0gLycKICAgIGRvbmUKICBkb25lCiAgZWNobyAiUmUtYWZmaW5lZCAkc3VjY2Vzc2NvdW50IHBpZHMgc3VjY2Vzc2Z1bGx5IgogIGlmIFtbICRmYWlsY291bnQgLWd0IDAgXV07IHRoZW4KICAgIGVjaG8gIkZhaWxlZCB0byByZS1hZmZpbmUgJGZhaWxjb3VudCBwcm9jZXNzZXMiCiAgICByZXR1cm4gMQogIGZpCn0KCnNldFVucmVzdHJpY3RlZCgpIHsKICBsb2dnZXIgIlNldHRpbmcgY3JpdGljYWwgc3lzdGVtIHByb2Nlc3NlcyB0byBoYXZlIHVucmVzdHJpY3RlZCBDUFUgYWNjZXNzIgogIHJlc2V0QWZmaW5pdHkgIiQodW5yZXN0cmljdGVkQ3B1c2V0KSIKfQoKc2V0UmVzdHJpY3RlZCgpIHsKICBsb2dnZXIgIlJlc2V0dGluZyBjcml0aWNhbCBzeXN0ZW0gcHJvY2Vzc2VzIGJhY2sgdG8gbm9ybWFsbHkgcmVzdHJpY3RlZCBhY2Nlc3MiCiAgcmVzZXRBZmZpbml0eSAiJChyZXN0cmljdGVkQ3B1c2V0KSIKfQoKY3VycmVudEFmZmluaXR5KCkgewogIGxvY2FsIHBpZD0iJDEiCiAgdGFza3NldCAtcGMgJHBpZCB8IGF3ayAtRic6ICcgJ3twcmludCAkMn0nCn0KCndhaXRGb3JSZWFkeSgpIHsKICBlY2hvICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogIGVjaG8gIldhaXRpbmcgJHtNQVhJTVVNX1dBSVRfVElNRX1zIGZvciB0aGUgaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUiCiAgbG9jYWwgbGFzdFN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogIGxvY2FsIGxhc3REZXNpcmVkQ3B1c2V0PSIkKHVucmVzdHJpY3RlZENwdXNldCkiCiAgbG9jYWwgdD0wIHM9MTAKICB3aGlsZSBbWyAkdCAtbHQgJE1BWElNVU1fV0FJVF9USU1FIF1dOyBkbwogICAgIyBUT0RPOiBDYW4gd2UgcXVlcnkgdGhlIHN0YXRlIHNvbWVob3cgYW5kIGludGVycnVwdCB0aGlzIHNvb25lcj8KICAgICMgRG9lcyAnY3Jpbycga25vdyB3aGVuIHdlJ3JlICJkb25lIj8gIE1heWJlIHZpYSAnY3JpY3RsIHBzIHwgZ3JlcCBQZW5kaW5nIHwgd2MgLWwnPwogICAgbG9jYWwgcGVuZGluZz0kKGNyaWN0bCBwcyB8IGdyZXAgUGVuZGluZyB8IHdjIC1sKQogICAgZWNobyAiREVCVUc6IENyaW8gbGlzdHMgJHBlbmRpbmcgY29udGFpbmVycyBhcyBQZW5kaW5nIgogICAgc2xlZXAgJHMKICAgICgodCArPSBzKSkKICAgIGxvY2FsIHN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogICAgbG9jYWwgZGVzaXJlZENwdXNldD0iJCh1bnJlc3RyaWN0ZWRDcHVzZXQpIgogICAgIyBCZWNhdXNlICd0dW5lZCcgbWF5IG1lc3Mgd2l0aCB1cywgYW5kIHRoZSBhbGxvd2VkIHNldCBvZiB1bnJlc2VydmVkCiAgICAjIGNvcmVzIG1heSBjaGFuZ2UgYXMgcG9kcyBjb21lIHVwLCB3ZSBuZWVkIHRvIHJlYXNzZXJ0IHRoZSB1bnJlc3RyaWN0ZWQKICAgICMgYWZmaW5pdHkgaWYgaXQncyBub3QgY29ycmVjdAogICAgaWYgW1sgJHN5c3RlbWRDcHVzZXQgIT0gJGxhc3RTeXN0ZW1kQ3B1c2V0IHx8ICRsYXN0RGVzaXJlZENwdXNldCAhPSAkZGVzaXJlZENwdXNldCBdXTsgdGhlbgogICAgICByZXNldEFmZmluaXR5ICIkZGVzaXJlZENwdXNldCIKICAgICAgbGFzdFN5c3RlbWRDcHVzZXQ9IiQoY3VycmVudEFmZmluaXR5IDEpIgogICAgICBsYXN0RGVzaXJlZENwdXNldD0iJGRlc2lyZWRDcHVzZXQiCiAgICBmaQogIGRvbmUKfQoKaWYgISB1bnJlc3RyaWN0ZWRDcHVzZXQgPiYvZGV2L251bGw7IHRoZW4KICBlY2hvICJObyB1bnJlc3RyaWN0ZWQgQ3B1c2V0IGNvdWxkIGJlIGRldGVjdGVkLiAgUGVyaGFwcyBrdWJlbGV0IGlzIG5vdCBydW5uaW5nIHlldD8iCiAgZXhpdCAxCmZpCgppZiAhIHJlc3RyaWN0ZWRDcHVzZXQgPiYvZGV2L251bGw7IHRoZW4KICBlY2hvICJObyByZXN0cmljdGVkIENwdXNldCBoYXMgYmVlbiBjb25maWd1cmVkLiAgV2UgYXJlIGFscmVhZHkgcnVubmluZyB1bnJlc3RyaWN0ZWQuIgogIGV4aXQgMApmaQoKIyBFbnN1cmUgd2UgcmVzZXQgdGhlIENQVSBhZmZpbml0eSB3aGVuIHdlIGV4aXQgdGhpcyBzY3JpcHQgZm9yIGFueSByZWFzb24KIyBUaGlzIHdheSBlaXRoZXIgYWZ0ZXIgdGhlIHRpbWVyIGV4cGlyZXMgb3IgYWZ0ZXIgdGhlIHByb2Nlc3MgaXMgaW50ZXJydXB0ZWQKIyB2aWEgXkMgb3IgU0lHVEVSTSwgd2UgcmV0dXJuIHRoaW5ncyBiYWNrIHRvIHRoZSB3YXkgdGhleSBzaG91bGQgYmUuCnRyYXAgc2V0UmVzdHJpY3RlZCBFWElUCgpzZXRVbnJlc3RyaWN0ZWQKd2FpdEZvclJlYWR5Cg==
        mode: 493
        path: /usr/local/bin/accelerated-container-startup.sh
    systemd:
      units:
      - contents: |
          [Path]
          PathExists=/var/lib/kubelet/cpu_manager_state

          [Install]
          WantedBy=multi-user.target
        enabled: true
        name: accelerated-container-startup.path
      - contents: |
          [Unit]
          Description=Unlocks more CPUs for critical system processes during container startup
          After=kubelet.service

          [Service]
          Type=simple
          ExecStart=/usr/local/bin/accelerated-container-startup.sh
        enabled: true
        name: accelerated-container-startup.service
      - contents: |
          [Unit]
          Description=Unlocks more CPUs for critical system processes during container shutdown
          DefaultDependencies=no

          [Service]
          Type=simple
          ExecStart=/usr/local/bin/accelerated-container-startup.sh

          [Install]
          WantedBy=shutdown.target reboot.target halt.target
        enabled: true
        name: accelerated-container-shutdown.service
